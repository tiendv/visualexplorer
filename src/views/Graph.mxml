<?xml version="1.0" encoding="utf-8"?>
<s:Group xmlns:fx="http://ns.adobe.com/mxml/2009" 
		 xmlns:s="library://ns.adobe.com/flex/spark" 
		 xmlns:mx="library://ns.adobe.com/flex/mx" width="100%" height="100%">
	<fx:Script>
		<![CDATA[
			import business.events.SearchAuthorEvent;
			
			import flash.sampler.NewObjectSample;
			
			import flashx.textLayout.factory.TruncationOptions;
			
			import models.ModelLocator;
			
			import mx.collections.ArrayCollection;
			import mx.collections.ArrayList;
			import mx.controls.Alert;
			
			import spark.events.IndexChangeEvent;
			
			import valueobjects.AuthorOrgObject;
			
			[Bindable]
			public var searchAuthors:ArrayCollection = ModelLocator.getInstance().searchedAuthors;
			
			public var dataLeft:Object = new Object();
			public var dataRight:Object = new Object();
			public var isCoGraph:Boolean = true;
			public var isCoPath:Boolean = false;
			public var isCitation:Boolean = false;
			public var isRecommend:Boolean = false;
			
			protected function btnHideLeft_clickHandler(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
				SearchLeft.visible = !SearchLeft.visible;
				btnHideLeft.visible = false;
				btnShowLeft.visible = true;
				vrLeft.x = vrLeft.x - 190;
			}
			protected function btnShowLeft_clickHandler(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
				SearchLeft.visible = !SearchLeft.visible;
				btnHideLeft.visible = true;
				btnShowLeft.visible = false;
				vrLeft.x = vrLeft.x + 190;
			}
			protected function btnHideRight_clickHandler(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
				SearchRight.visible = !SearchRight.visible;
				btnHideRight.visible = false;
				btnShowRight.visible = true;
				vrRight.x = vrRight.x + 180;
			}
			protected function btnShowRight_clickHandler(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
				SearchRight.visible = !SearchRight.visible;
				btnHideRight.visible = true;
				btnShowRight.visible = false;
				vrRight.x = vrRight.x - 180;
			}
			
			protected function btnSearchLeft_clickHandler(event:MouseEvent):void
			{
				var searchAuthorEvent:SearchAuthorEvent = new SearchAuthorEvent(txtAuthorNameLeft.text);
				searchAuthorEvent.dispatch();
			}
			
			protected function btnCoAuthorPath_clickHandler(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
				if(dataLeft.authorID>0 && dataRight.authorID>0 && isCoPath==false){
					var dataUrlReplace:Object = new Object();
					dataUrlReplace.urlReplace = dataLeft.authorID+"&"+dataRight.authorID;
					setUrlReplace(dataUrlReplace);
				}

				isCoGraph = false;
				isCoPath = true;
				isCitation = false;
				isRecommend = false;

				SearchRight.visible = true;
				vrRight.visible = true;
				btnHideRight.visible = true;
				btnShowRight.visible = false;
				SearchRight.x = width - 190;
				vrRight.x = width - 200;
				btnHideRight.x = width - 210;
				btnShowRight.x = width - 30;
			}
			
			protected function btnCoAuthorGraph_clickHandler(event:MouseEvent):void
			{
				vrRight.x = width-30;
				// TODO Auto-generated method stub
				if(dataLeft.authorID > 0 && isCoGraph==false){
					var dataUrlReplace:Object = new Object();
					dataUrlReplace.urlReplace = dataLeft.authorID;
					setUrlReplace(dataUrlReplace);
				}
				isCoGraph = true;
				isCoPath = false;
				isCitation = false;
				isRecommend = false;

				SearchRight.visible = false;
				vrRight.visible = false;
				btnHideRight.visible = false;
				btnShowRight.visible = false;
			}
			
			protected function btnCitationGraph_clickHandler(event:MouseEvent):void
			{
				vrRight.x = width-30
				// TODO Auto-generated method stub
				if(dataLeft.authorID > 0 && isCitation==false){
					var dataUrlReplace:Object = new Object();
					dataUrlReplace.urlReplace = dataLeft.authorID + "&citation";;
					setUrlReplace(dataUrlReplace);
				}
				isCoGraph = false;
				isCoPath = false;
				isCitation = true;
				isRecommend = false;

				SearchRight.visible = false;
				vrRight.visible = false;
				btnHideRight.visible = false;
				btnShowRight.visible = false;
			}
			
			protected function btnRecommend_clickHandler(event:MouseEvent):void
			{
				vrRight.x = width-30
				// TODO Auto-generated method stub
				if(dataLeft.authorID > 0 && isRecommend==false){
					var dataUrlReplace:Object = new Object();
					dataUrlReplace.urlReplace = dataLeft.authorID + "&recommend";
					setUrlReplace(dataUrlReplace);
				}
				isCoGraph = false;
				isCoPath = false;
				isCitation = false;
				isRecommend = true;

				SearchRight.visible = false;
				vrRight.visible = false;
				btnHideRight.visible = false;
				btnShowRight.visible = false;
			}
			protected function lst_changeHandlerLeft(e:IndexChangeEvent):void {
				dataLeft = e.currentTarget.selectedItem;
				var dataUrlReplace:Object = new Object();
				dataUrlReplace.urlReplace = "";
				if(isCoGraph){
					dataUrlReplace.urlReplace = +dataLeft.authorID;
				}
				if(isCoPath){
					dataUrlReplace.urlReplace = dataLeft.authorID+"&"+dataRight.authorID;
				}
				if(isCitation){
					dataUrlReplace.urlReplace = +dataLeft.authorID+"&citation";
				}
				if(isRecommend){
					dataUrlReplace.urlReplace = +dataLeft.authorID+"&recommend";
				}
				
				setTitle(dataLeft);
				setUrlReplace(dataUrlReplace);
			}
			protected function lst_changeHandlerRight(e:IndexChangeEvent):void {
				dataRight = e.currentTarget.selectedItem;
				var dataUrlReplace:Object = new Object();
				dataUrlReplace.urlReplace = "";
				if(isCoPath){
					dataUrlReplace.urlReplace = dataLeft.authorID+"&"+dataRight.authorID;
				}
				setUrlReplace(dataUrlReplace);
			}
			
			public function setTitle(data:Object):void{				
				var s:String;
				if(ExternalInterface.available){
					var wrapperFunction:String = "receiveComplexDataTypes";
					s = ExternalInterface.call(wrapperFunction,data);
				}else{
					s = "wrapper not available";
				}
				trace(s);
			}
			
			public function setUrlReplace(data:Object):void{
				Alert.show(data.urlReplace);
				var s:String;
				if(ExternalInterface.available){
					var wrapperFunction:String = "receiveUrlReplace";
					s = ExternalInterface.call(wrapperFunction,data);
				}else{
					s = "wrapper not available";
				}
				trace(s);
			}
		]]>
	</fx:Script>
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
	</fx:Declarations>
	<s:BorderContainer id="SearchLeft" x="10" y="0" width="184" height="100%" borderVisible="false">
		<s:BorderContainer x="11" y="1" width="158" height="32" borderColor="#727BFC"
						   color="#183CF0" symbolColor="#3E5BF0">
			<s:TextInput id="txtAuthorNameLeft" x="3" y="5" width="123" borderVisible="false"
						 color="#000000"/>
			<s:Button id="btnSearchLeft" x="128" y="2" width="25" height="25" buttonMode="true"
					  enabled="true" icon="@Embed('assets/gui/button_Search.png')" useHandCursor="true"
					  click="btnSearchLeft_clickHandler(event)" />
		</s:BorderContainer>
		<s:Label x="10" y="40" text="Result"/>
		<s:List id="lstLeft" x="10" y="60" width="170" height="{height-70}" borderVisible="false"
				changing="lst_changeHandlerLeft(event)" 
				dataProvider="{searchAuthors}"
				itemRenderer="views.CustomItemRen" useHandCursor="true">
			
			<s:layout>
				<s:VerticalLayout gap="0"
								  horizontalAlign="justify"
								  requestedRowCount="5" />
			</s:layout>
			
		</s:List>
	</s:BorderContainer>
	<mx:VRule id="vrLeft" x="207" y="1" width="2" height="100%" chromeColor="#000000"/>
	<mx:Button id="btnHideLeft" x="196" y="{(height/2)-20}" width="25" height="25"
			   click="btnHideLeft_clickHandler(event)" cornerRadius="12"
			   icon="@Embed('assets/gui/button_hide.png')" paddingLeft="0" paddingRight="0"
			   overIcon="@Embed('assets/gui/btn_hide_hover.png')"
			   buttonMode="true" useHandCursor="true"
			   visible="true"/>
	<mx:Button id="btnShowLeft" x="6" y="{(height/2)-20}" width="25" height="25"
			   click="btnShowLeft_clickHandler(event)" cornerRadius="12"
			   icon="@Embed('assets/gui/btn_show.png')" paddingLeft="0" paddingRight="0"
			   overIcon="@Embed('assets/gui/btn_show_hover.png')"
			   buttonMode="true" useHandCursor="true"
			   visible="false"/>
	
	<mx:Canvas id="graphBody"
			   x ="{vrLeft.x + 15}" y="31"
			   height="100%" width="{vrRight.x - vrLeft.x - 25}" borderStyle="solid">
		
	</mx:Canvas>
	
	<s:BorderContainer id="SearchRight" x="760" y="0" width="184" height="100%" borderVisible="false" visible="false">
		<s:BorderContainer x="11" y="1" width="158" height="32" borderColor="#727BFC"
						   color="#183CF0" symbolColor="#3E5BF0">
			<s:TextInput id="txtAuthorNameRight" x="3" y="5" width="123" borderVisible="false"
						 color="#000000"/>
			<s:Button id="btnSearchRight" x="128" y="2" width="25" height="25" icon="@Embed('assets/gui/button_Search.png')"
					  buttonMode="true" useHandCursor="true"/>
		</s:BorderContainer>
		<s:Label x="10" y="40" text="Result"/>
		<s:List id="lstRight" x="10" y="60" width="170" height="{height-70}" borderVisible="false"
				changing="lst_changeHandlerRight(event)"
				itemRenderer="views.CustomItemRen" useHandCursor="true">
			
			<s:layout>
				<s:VerticalLayout gap="0"
								  horizontalAlign="justify"
								  requestedRowCount="5" />
			</s:layout>
			
		</s:List>
	</s:BorderContainer>
	<mx:VRule id="vrRight" x="{width-30}" y="1" width="2" height="100%" chromeColor="#000000" visible="false"/>
	<mx:Button id="btnHideRight" x="730" y="{(height/2)-20}" width="25" height="25"
			   click="btnHideRight_clickHandler(event)" cornerRadius="12"
			   icon="@Embed('assets/gui/btn_show.png')" paddingLeft="0" paddingRight="0"
			   overIcon="@Embed('assets/gui/btn_show_hover.png')"
			   buttonMode="true" useHandCursor="true"
			   visible="false"/>
	<mx:Button id="btnShowRight" x="920" y="{(height/2)-20}" width="25" height="25"
			   click="btnShowRight_clickHandler(event)" cornerRadius="12"
			   icon="@Embed('assets/gui/button_hide.png')" paddingLeft="0" paddingRight="0"
			   overIcon="@Embed('assets/gui/btn_hide_hover.png')"
			   buttonMode="true" useHandCursor="true"
			   visible="false"/>
	<mx:Button id="btnCoAuthorGraph" x="217" y="1" label="Co-author Graph"
			   click="btnCoAuthorGraph_clickHandler(event)" />
	<mx:Button id="btnCoAuthorPath" x="331" y="1" label="Co-author Path"
			   click="btnCoAuthorPath_clickHandler(event)" enabled="true"/>
	<mx:Button id="btnCitationGraph" x="436" y="1" label="Citation Graph"
			   click="btnCitationGraph_clickHandler(event)"/>
	<s:Button id="btnRecommend" x="537" y="1" label="Recommend"
			  click="btnRecommend_clickHandler(event)"/>
</s:Group>
